# 2512 Hack for Change - ゲーム仕様書

## 概要
日々の生活における行動選択が環境に与える影響をテーマにしたシミュレーションゲームです。プレイヤーの選択によって「豊作率（Harvest Percent）」と「スコア」が変化し、ゲーム終了時の結果画面でその成果を確認できます。

## コアメカニクス
- **ターン制**: 1ゲームセッションにつき3つの「シチュエーション」をプレイします。
- **ランダム選出**: 全4種類のシチュエーションから重複なしでランダムに選ばれます。
- **豊作システム（Harvest System）**: 
  - 初期値: 100%
  - 範囲: 0% ～ 300%
  - 影響: 選択によって増減（基本 +/- 30%）。ポップアップで農家の変化を視覚的にフィードバックします。
- **スコア**:
  - ターンの成果に基づいて蓄積されます。
  - 最終的な豊作率に応じてボーナスが付与されます。

## シチュエーション詳細
各シチュエーションは4つの連続するシーンで構成されています。

### 1. 牛乳 (Milk)
家庭での消費から廃棄までのサイクルを扱います。
- **Scene 1: 玄関 (Entrance)**: 
  - エコバッグを持つ (+30) vs 持たない (0)
  - ※この選択はシーン遷移せず、フラグのみ更新されます。
- **Scene 2: 外出 (Outside)**: 
  - 徒歩 (+30) vs 車 (-30) vs 電車 (+10)
  - ※次のシーン（スーパー）へ移動するための手段選択。
- **Scene 3: スーパー (Market)**: 
  - 小容量・長持ち (+10) vs 大容量・短期限 (-10)
  - ※食品ロスと廃棄リスクを考慮した選択。
- **Scene 4: 廃棄 (Disposal)**: 
  - 洗ってリサイクル (+30) vs そのまま捨てる (-30)

### 2. ネットショッピング (Shopping)
購入から配送、返品までの物流と梱包の影響を扱います。
- **Scene 1: 商品詳細 (Detail)**: 
  - 中古/リファービッシュ品 (+30) vs 新品 (-30)
- **Scene 2: 注文オプション (Order)**: 
  - 以下のオプションを複数選択可能：
    - まとめて配送 (+30)
    - エコ梱包 (+20)
    - 電子明細 (+10)
  - 全て選択しない場合は環境負荷増 (-30相当)
- **Scene 3: 受取 (Delivery)**: 
  - 宅配ボックス/対面受取 (+30) vs 再配達 (-30)
- **Scene 4: 返品 (Return)**: 
  - まとめて返送 (+30) vs 個別返送 (-30)

### 3. 水回り・お風呂 (Water)
家庭での水使用における節水意識を扱います。
- **Scene 1: 洗面所 (Washbasin)**: 
  - コップを使う/節水モード (+30) vs 流しっぱなし (-30)
- **Scene 2: シャワー準備 (Shower)**: 
  - 溜めて再利用 (+30) vs お湯になるまで流す (-30)
- **Scene 3: シャンプー (Shampoo)**: 
  - こまめに止める (+30) vs 出しっぱなし (-30)
- **Scene 4: 掃除 (Cleaning)**: 
  - エコ洗剤/予洗い (+30) vs 強力洗剤多用 (-30)

### 4. 空調・エアコン (Aircon)
電力消費と温度管理、メンテナンスを扱います。
- **Scene 1: 温度設定 (Temp)**: 
  - 適温/自動運転 (+30) vs 極端な温度 (-30)
- **Scene 2: カーテン (Curtain)**: 
  - 閉める/日差し活用 (+30) vs 開けっ放し (-30)
- **Scene 3: 外出時 (Going Out)**: 
  - こまめに消す/タイマー (+30) vs つけっぱなし (-30)
- **Scene 4: フィルター (Filter)**: 
  - 掃除する/省エネモード (+30) vs 掃除しない (-30)

## 技術スタックとアーキテクチャ
- **フレームワーク**: Next.js (App Router), React, TypeScript
- **状態管理**: `useGameState` カスタムフック
  - `mode`: ゲームの状態（マップ、シーン、リザルト等）
  - `harvestPercent`: 現在の豊作率
  - `playedSituations`: プレイ済みのシチュエーション履歴
  - `actionLogs`: プレイヤーの全行動ログ
- **シーン管理システム**: 
  - `SceneRenderer`: `sceneName` プロパティに基づいて動的にコンポーネントを切り替えます。
  - 各シーンは独立したコンポーネントとして実装され、`SceneProps` を受け取ります。
- **UIコンポーネント**:
  - `TouchButton`: ユーザーインタラクション用ボタン
  - `FarmerImpactPopup`: 選択結果のフィードバック（農家のビジュアル変化とテキスト）
  - `RiceBowl`: ターン終了時のスコア集計演出
  - `FinalResult`: 最終結果と行動ログの表示

## データ構造
### 行動ログ (Action Log)
```typescript
{
  situation: string; // "shopping", "milk" 等のシチュエーションID
  action: string;    // "エコバッグを持つ" 等の行動内容テキスト
  impact: number;    // 変動値 (例: 30, -30)
}
```

### 豊作レベル (Harvest Levels)
- **0-60%**: 枯れた大地 (Worst)
- **60-120%**: 元気がない (Bad)
- **120-180%**: 普通 (Normal)
- **180-240%**: 豊作 (Good)
- **240%以上**: 大豊作 (Best)

## 今後の拡張性
- `page.tsx` の `ALL_SITUATIONS` 定数に新しいIDを追加することでシチュエーションを増やせます。
- 新しいシーンコンポーネントを作成し、`SceneRenderer.tsx` の switch 文に追加するだけで実装可能です。
- 現在プレースホルダー (`tmp.png`) を使用している画像の差し替えが容易な設計になっています。
